{
  "name": "Claude Code Feature Generator v1",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "generate-feature",
        "responseMode": "responseNode",
        "options": {
          "rawBody": true
        }
      },
      "id": "webhook-trigger",
      "name": "ğŸ¯ Webhook - Receive Feature Request",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [250, 300],
      "webhookId": "claude-code-feature-gen"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.body.feature_description}}",
              "operation": "isNotEmpty"
            },
            {
              "value1": "={{$json.body.codebase_path}}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "validate-input",
      "name": "âœ… Validate - Input Schema",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [450, 300]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "error",
              "value": "Missing required fields: feature_description and codebase_path"
            },
            {
              "name": "status",
              "value": "error"
            }
          ]
        },
        "options": {}
      },
      "id": "validation-error",
      "name": "âš ï¸ Set - Validation Error",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [650, 450]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{$json}}",
        "options": {
          "responseCode": 400
        }
      },
      "id": "send-validation-error",
      "name": "âœ‰ï¸ Send - Error Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [850, 450]
    },
    {
      "parameters": {
        "command": "cd \"={{$json.body.codebase_path}}\" && ls -la",
        "timeout": 5000
      },
      "id": "verify-codebase",
      "name": "ğŸ“‚ Verify - Codebase Path Exists",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [650, 150]
    },
    {
      "parameters": {
        "command": "cd \"={{$json.body.codebase_path}}\" && echo \"={{$json.body.feature_description}}\" > .claude/temp_feature_request.md",
        "timeout": 5000
      },
      "id": "write-feature-file",
      "name": "ğŸ“ Write - Feature Description File",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [850, 150]
    },
    {
      "parameters": {
        "command": "cd \"={{$json.body.codebase_path}}\" && claude /flow:prd < .claude/temp_feature_request.md",
        "timeout": 300000
      },
      "id": "execute-prd-command",
      "name": "ğŸ¤– Execute - Claude PRD Generation",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [1050, 150]
    },
    {
      "parameters": {
        "jsCode": "const output = $input.item.json.stdout || '';\nconst errorOutput = $input.item.json.stderr || '';\n\n// Extract PRD file path from output\nconst prdPathMatch = output.match(/(?:prd_[a-z0-9_]+_\\d{8}\\.md)/);\nconst prdFilePath = prdPathMatch ? prdPathMatch[0] : null;\n\nif (!prdFilePath) {\n  throw new Error('Failed to extract PRD file path from command output');\n}\n\nreturn {\n  prd_file_path: prdFilePath,\n  prd_output: output,\n  error_output: errorOutput,\n  status: 'prd_generated'\n};"
      },
      "id": "parse-prd-output",
      "name": "ğŸ“ Parse - PRD Output",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1250, 150]
    },
    {
      "parameters": {
        "command": "cd \"={{$json.body.codebase_path}}\" && echo \"={{$json.prd_file_path}}\" | claude /flow:design",
        "timeout": 300000
      },
      "id": "execute-design-command",
      "name": "ğŸ¤– Execute - Claude Design Generation",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [1450, 150]
    },
    {
      "parameters": {
        "jsCode": "const output = $input.item.json.stdout || '';\nconst errorOutput = $input.item.json.stderr || '';\n\n// Extract TDD file path from output\nconst tddPathMatch = output.match(/(?:tdd_[a-z0-9_]+_\\d{8}\\.md)/);\nconst tddFilePath = tddPathMatch ? tddPathMatch[0] : null;\n\nif (!tddFilePath) {\n  throw new Error('Failed to extract TDD file path from command output');\n}\n\nreturn {\n  tdd_file_path: tddFilePath,\n  tdd_output: output,\n  error_output: errorOutput,\n  status: 'design_generated'\n};"
      },
      "id": "parse-tdd-output",
      "name": "ğŸ“ Parse - TDD Output",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1650, 150]
    },
    {
      "parameters": {
        "command": "cd \"={{$json.body.codebase_path}}\" && echo \"={{$json.tdd_file_path}}\" | claude /flow:tasks",
        "timeout": 300000
      },
      "id": "execute-tasks-command",
      "name": "ğŸ¤– Execute - Claude Tasks Generation",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [1850, 150]
    },
    {
      "parameters": {
        "jsCode": "const output = $input.item.json.stdout || '';\nconst errorOutput = $input.item.json.stderr || '';\n\n// Extract tasks file path from output\nconst tasksPathMatch = output.match(/(?:tasks_[a-z0-9_]+_\\d{8}\\.md)/);\nconst tasksFilePath = tasksPathMatch ? tasksPathMatch[0] : null;\n\nif (!tasksFilePath) {\n  throw new Error('Failed to extract tasks file path from command output');\n}\n\nreturn {\n  tasks_file_path: tasksFilePath,\n  tasks_output: output,\n  error_output: errorOutput,\n  status: 'tasks_generated'\n};"
      },
      "id": "parse-tasks-output",
      "name": "ğŸ“ Parse - Tasks Output",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2050, 150]
    },
    {
      "parameters": {
        "command": "cd \"={{$json.body.codebase_path}}\" && echo \"={{$json.tasks_file_path}}\" | claude /flow:execute-task",
        "timeout": 1800000
      },
      "id": "execute-tasks",
      "name": "ğŸ¤– Execute - Claude Code Generation",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [2250, 150]
    },
    {
      "parameters": {
        "jsCode": "const output = $input.item.json.stdout || '';\nconst errorOutput = $input.item.json.stderr || '';\nconst exitCode = $input.item.json.exitCode || 0;\n\n// Check if execution was successful\nconst success = exitCode === 0;\n\nreturn {\n  execution_output: output,\n  error_output: errorOutput,\n  exit_code: exitCode,\n  status: success ? 'code_generated' : 'execution_failed',\n  success: success,\n  timestamp: new Date().toISOString()\n};"
      },
      "id": "parse-execution-output",
      "name": "ğŸ“ Parse - Execution Output",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2450, 150]
    },
    {
      "parameters": {
        "command": "cd \"={{$json.body.codebase_path}}\" && rm -f .claude/temp_feature_request.md",
        "timeout": 5000
      },
      "id": "cleanup-temp-files",
      "name": "ğŸ§¹ Cleanup - Temp Files",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [2650, 150]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "status",
              "value": "success"
            },
            {
              "name": "message",
              "value": "Feature code generated successfully"
            }
          ]
        },
        "options": {}
      },
      "id": "format-success-response",
      "name": "âœ¨ Format - Success Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [2850, 150]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{{\n  \"status\": $json.status,\n  \"message\": $json.message,\n  \"prd_file\": $('parse-prd-output').item.json.prd_file_path,\n  \"tdd_file\": $('parse-tdd-output').item.json.tdd_file_path,\n  \"tasks_file\": $('parse-tasks-output').item.json.tasks_file_path,\n  \"execution_summary\": $('parse-execution-output').item.json.execution_output.substring(0, 500),\n  \"timestamp\": $('parse-execution-output').item.json.timestamp\n}}}",
        "options": {
          "responseCode": 200
        }
      },
      "id": "send-success-response",
      "name": "âœ‰ï¸ Send - Success Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [3050, 150]
    },
    {
      "parameters": {
        "mode": "catchError",
        "errorMessage": "={{$json.message || 'Unknown error occurred'}}",
        "options": {}
      },
      "id": "error-trigger",
      "name": "âš ï¸ On Error",
      "type": "n8n-nodes-base.errorTrigger",
      "typeVersion": 1,
      "position": [1450, 450]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "status",
              "value": "error"
            },
            {
              "name": "message",
              "value": "={{$json.error?.message || 'Workflow execution failed'}}"
            },
            {
              "name": "step",
              "value": "={{$json.error?.node || 'unknown'}}"
            }
          ]
        },
        "options": {}
      },
      "id": "format-error-response",
      "name": "âš ï¸ Format - Error Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [1650, 450]
    },
    {
      "parameters": {
        "command": "cd \"={{$('webhook-trigger').item.json.body.codebase_path}}\" && rm -f .claude/temp_feature_request.md",
        "timeout": 5000,
        "continueOnFail": true
      },
      "id": "cleanup-on-error",
      "name": "ğŸ§¹ Cleanup - On Error",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [1850, 450]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{$json}}",
        "options": {
          "responseCode": 500
        }
      },
      "id": "send-error-response",
      "name": "âœ‰ï¸ Send - Error Response Final",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [2050, 450]
    }
  ],
  "connections": {
    "ğŸ¯ Webhook - Receive Feature Request": {
      "main": [
        [
          {
            "node": "âœ… Validate - Input Schema",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… Validate - Input Schema": {
      "main": [
        [
          {
            "node": "ğŸ“‚ Verify - Codebase Path Exists",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âš ï¸ Set - Validation Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš ï¸ Set - Validation Error": {
      "main": [
        [
          {
            "node": "âœ‰ï¸ Send - Error Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‚ Verify - Codebase Path Exists": {
      "main": [
        [
          {
            "node": "ğŸ“ Write - Feature Description File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Write - Feature Description File": {
      "main": [
        [
          {
            "node": "ğŸ¤– Execute - Claude PRD Generation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– Execute - Claude PRD Generation": {
      "main": [
        [
          {
            "node": "ğŸ“ Parse - PRD Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Parse - PRD Output": {
      "main": [
        [
          {
            "node": "ğŸ¤– Execute - Claude Design Generation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– Execute - Claude Design Generation": {
      "main": [
        [
          {
            "node": "ğŸ“ Parse - TDD Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Parse - TDD Output": {
      "main": [
        [
          {
            "node": "ğŸ¤– Execute - Claude Tasks Generation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– Execute - Claude Tasks Generation": {
      "main": [
        [
          {
            "node": "ğŸ“ Parse - Tasks Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Parse - Tasks Output": {
      "main": [
        [
          {
            "node": "ğŸ¤– Execute - Claude Code Generation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– Execute - Claude Code Generation": {
      "main": [
        [
          {
            "node": "ğŸ“ Parse - Execution Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Parse - Execution Output": {
      "main": [
        [
          {
            "node": "ğŸ§¹ Cleanup - Temp Files",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ§¹ Cleanup - Temp Files": {
      "main": [
        [
          {
            "node": "âœ¨ Format - Success Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ¨ Format - Success Response": {
      "main": [
        [
          {
            "node": "âœ‰ï¸ Send - Success Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš ï¸ On Error": {
      "main": [
        [
          {
            "node": "âš ï¸ Format - Error Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš ï¸ Format - Error Response": {
      "main": [
        [
          {
            "node": "ğŸ§¹ Cleanup - On Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ§¹ Cleanup - On Error": {
      "main": [
        [
          {
            "node": "âœ‰ï¸ Send - Error Response Final",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": ""
  },
  "staticData": null,
  "tags": [
    {
      "name": "AI Automation",
      "id": "ai-automation"
    },
    {
      "name": "Code Generation",
      "id": "code-gen"
    },
    {
      "name": "Claude Code",
      "id": "claude-code"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-11-16T00:00:00.000Z",
  "versionId": "1"
}
